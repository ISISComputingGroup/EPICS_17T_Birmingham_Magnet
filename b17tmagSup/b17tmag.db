# record(bo, "$(P)SIM")
# {
#     field(SCAN, "Passive")
#     field(DTYP, "Soft Channel")
#     field(ZNAM, "NO")
#     field(ONAM, "YES")
#     field(VAL, "$(RECSIM=0)")
#     field(PINI, "YES")
# }

record(bo, "$(P)DISABLE"){
    field(DESC, "Disable comms")
    field(PINI, "YES")
    field(VAL, "$(DISABLE=0)")
    field(OMSL, "supervisory")
    field(ZNAM, "COMMS ENABLED")
    field(ONAM, "COMMS DISABLED")
}


record(ai, "$(P)FIELD"){
    field(DESC, "The field of the magnet at present")
    field(DTYP, "stream")
    field(INP, "@B17MAG.proto getField $(PORT)")
    field(SCAN, "1 second")
    field(EGU, "T")
    info(INTEREST, "HIGH")
}

record(ai, "$(P)CURR"){
    field(DESC, "The current of the magnet at present")
    field(DTYP, "stream")
    # field(INP, "@B17MAG.proto getCurrent") - part of getField
    field(EGU, "A")
    info(INTEREST, "HIGH")
}

record(mbbi, "$(P)HEATER"){
    field(DESC, "The status of the heater")
    field(DTYP, "stream")
    field(SCAN, "1 second")
    field(INP, "@B17MAG.proto getHeater")
    field(ZRVL, "0")
    field(ZRST, "ON")
    field(ONVL, "1")
    field(ONST, "OFF")
    field(TWVL, "2")
    field(TWST, "OFF AT FIELD")
    field(THVL, "3")
    field(THST, "NO MATCH")
    info(INTEREST, "HIGH")
}

record(ai, "$(P)FIELD:PERSIST"){
    field(DESC, "Persistent field of magnet at present")
    field(DTYP, "stream")
    field(SCAN, "1 second")
    field(EGU, "T")
    field(INP, "@B17MAG.proto getPersist")
    info(INTEREST, "HIGH")
}

record(ai, "$(P)CURR:PERSIST"){
    field(DESC, "Persistent current of magnet at present")
    field(DTYP, "stream")
    field(SCAN, "1 second")
    field(EGU, "A")
    field(INP, "@B17MAG.proto getPersist")
    info(INTEREST, "HIGH")
}

record(bi, "$(P)MODE:PERSIST"){
    field(DESC, "Whether the magnets in persistent mode")
    field(DTYP, "stream")
    field(SCAN, "1 second")
    field(INP, "@B17MAG.proto getPersistMode")
    field(ZNAM, "ON")
    field(ONAM, "OFF")
    info(INTEREST, "HIGH")
}

record(bi, "$(P)READY"){
    field(DESC, "Whether the magnets stable and at field")
    field(DTYP, "stream")
    field(SCAN, "1 second")
    field(INP, "@B17MAG.proto getReady")
    field(ZNAM, "ON")
    field(ONAM, "OFF")
    info(INTEREST, "HIGH")
}

# Low priority - need to run abort first (should be achievable in the protocol file)
record(ao, "$(P)FIELD:SP"){
    field(DESC, "The field to set")
    field(DTYP, "stream")
    field(EGU, "T")
    field(DOL, "@B17MAG.proto setField")
    info(INTEREST, "LOW")
}

record(bo, "$(P)MODE:PERSIST:SP"){
    field(DESC, "The persistent field to set")
    field(DTYP, "stream")
    field(DOL, "@B17MAG.proto setPersistMode")
    field(ZNAM, "ON")
    field(ONAM, "OFF")
    info(INTEREST, "LOW")
}

record(ai, "$(P)TEMP:A"){
    field(DESC, "The temperature at sensor A")
    field(DTYP, "stream")
    field(SCAN, "1 second")
    field(EGU, "K")
    field(INP, "@B17MAG.proto getTempA")
    info(INTEREST, "HIGH")
}

record(ai, "$(P)TEMP:B"){
    field(DESC, "The temperature at sensor B")
    field(DTYP, "stream")
    field(SCAN, "1 second")
    field(EGU, "K")
    field(INP, "@B17MAG.proto getTempB")
    info(INTEREST, "HIGH")
}

record(ai, "$(P)TEMP:SET1"){
    field(DESC, "The temperature for setpoint 1")
    field(DTYP, "stream")
    field(SCAN, "1 second")
    field(EGU, "K")
    field(INP, "@B17MAG.proto getSet1")
    info(INTEREST, "HIGH")
}

record(ai, "$(P)TEMP:SET2"){
    field(DESC, "The temperature for setpoint 2")
    field(DTYP, "stream")
    field(SCAN, "1 second")
    field(EGU, "K")
    field(INP, "@B17MAG.proto getSet2")
    info(INTEREST, "HIGH")
}

record(ao, "$(P)TEMP:SET1:SP"){
    field(DESC, "The temperature for setpoint 1")
    field(DTYP, "stream")
    field(EGU, "K")
    field(DOL, "@B17MAG.proto setSet1")
    info(INTEREST, "HIGH")
}

record(ao, "$(P)TEMP:SET2:SP"){
    field(DESC, "The temperature for setpoint 2")
    field(DTYP, "stream")
    field(EGU, "K")
    field(DOL, "@B17MAG.proto setSet2")
    info(INTEREST, "HIGH")
}

# Alias's
alias("$(P)TEMP:SET1", "$(P)TEMP:HEATEX")
alias("$(P)TEMP:SET1:SP", "$(P)TEMP:HEATEX:SP")
alias("$(P)TEMP:SET2", "$(P)TEMP:PROBE")
alias("$(P)TEMP:SET2:SP", "$(P)TEMP:PROBE:SP")


record(ai, "$(P)NV:POS"){
    field(DESC, "The position of the needle valve")
    field(DTYP, "stream")
    field(SCAN, "1 second")
    field(EGU, "mm")
    field(INP, "@B17MAG.proto getNeedlePosition")
    info(INTEREST, "HIGH")
}

record(ai, "$(P)NV:POS:RBV"){
    field(DESC, "The current pressue target")
    field(DTYP, "stream")
    field(SCAN, "1 second")
    field(EGU, "mbar")
    # field(INP, "@B17MAG.proto getPressure") Part of getPressure need to send in the prefix a well
    info(INTEREST, "HIGH")
}

record(ai, "$(P)NV:PRESSURE"){
    field(DESC, "The current pressure")
    field(DTYP, "stream")
    field(EGU, "mbar")
    # field(INP, "@B17MAG.proto getPressure") Part of getPressure need to send in the prefix a well
    info(INTEREST, "HIGH")
}

record(ao, "$(P)NV:PRESSURE:SP"){
    field(DESC, "The pressue target")
    field(DTYP, "stream")
    field(EGU, "mbar")
    field(DOL, "@B17MAG.proto setPressure")
}

record(ao, "$(P)NV:POS:SP"){
    field(DESC, "The target position for the needle valve")
    field(DTYP, "stream")
    field(EGU, "mm")
    field(DOL, "@B17MAG.proto setNeedlePosition")
}

record(ao, "$(P)ATTO:POS"){
    field(DESC, "Angle of the attocube")
    field(DTYP, "stream")
    field(SCAN, "1 second")
    field(EGU, "deg")
    field(DOL, "@B17MAG.proto getAttoAngle")
    info(INTEREST, "HIGH")
}

# Needs to be converted to a percentge of 243 
# (divide the returned value by 243 then multiply by 100) 
# - maybe possible at the proto file level
record(ai, "$(P)HE:LEVEL"){
    field(DESC, "The current level of helium")
    field(DTYP, "stream")
    field(SCAN, "1 second")
    field(EGU, "%")
    field(INP, "@B17MAG.proto getHelLevel")
    info(INTEREST, "HIGH")
}

record(ao, "$(P)ATTO:POS:SP"){
    field(DESC, "Angle for the AttoCube to go to")
    field(DTYP, "stream")
    field(EGU, "deg")
    field(INP, "@B17MAG.proto setAttoAngle")
    info(INTEREST, "LOW")
}

record(waveform, "$(P)MACRO:STAT") {
    field(DESC, "The current status of the system")
    field(NELM, "1024")
    field(FTVL, "STRING")
    field(SCAN, "1 second")
    field(INP, "@B17MAG.proto getMacroStatus") # Only read when MACRO:STAT:READ is True
    info(INTEREST, "MEDIUM")
}


# May need to be treated as a busy or similar.
# but allows for the reading (or not) of the status macro
record(bo, "$(P)MACRO:STAT:READ"){
    field(DESC, "Whether or not to read MACRO:STAT")
    info(INTEREST, "LOW")
}